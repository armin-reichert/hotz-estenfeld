\section{Subcategory, generating system}

\begin{definition}
Let \[ U = (Obj(U), Mor(U), Q_U, Z_U, \circ_U) \] and \[C = (Obj(C), Mor(C),
Q_C, Z_C, \circ_C)\] be categories.

$U$ is called a {\bf subcategory} of $C \Leftrightarrow$
\begin{enumerate}
  \item $Obj(U) \subset Obj(C)$ and $Mor(U) \subset Mor(C)$
  \item $Q_U = Q_C|_{Mor(U)}$ and $Z_U = Z_C|_{Mor(U)}$
  \item $\circ_U = \circ_C|_{Mor(U) \times Mor(U)}$
  \item $w \in Obj(U) \Rightarrow 1_w \in Mor(U)$
\end{enumerate}
\end{definition}

$U$ is called {\bf full subcategory} of $C \Leftrightarrow$
\[ \forall w_1, w_2 \in Obj(U),\ f: w_1 \to w_2 \in Mor(C) \Rightarrow f \in
Mor(U) \]

In a full subcategory, all morphisms of $C$ between objects in $U$ are also
morphisms in $U$. $f: w_1 \to w_2$ stands for $Q(f) = w_1 \wedge Z(f) = w_2$.

We want to explain this fact at some examples:

{\bf Example 1}:

Let $A = \setof{x,y,z,a,b,c}$ and $f, g, h: A^* \to A^*$ be mappings defined
as follows:
\[ f(u_1 \cdot x \cdot u_2 \cdot x \cdots x \cdot u_k \cdot x) = 
u_1 \cdot ax \cdot u_2 \cdot ax \cdots ax \cdot u_k \cdot ax \]
where $u_i \in (A - \setof{x})^*$,
\[ g(u_1 \cdot y \cdot u_2 \cdot y \cdots y \cdot u_k \cdot y) = 
u_1 \cdot by \cdot u_2 \cdot by \cdots by \cdot u_k \cdot by \]
where $u_i \in (A - y\})^*$,
\[ h(u_1 \cdot z \cdot u_2 \cdot z \cdots z \cdot u_k \cdot z) = 
u_1 \cdot cz \cdot u_2 \cdot cz \cdots cz \cdot u_k \cdot cz) \]
where $u_i \in (A - z\})^*$.

Let $M$ be the monoid of mappings $m: A^* \to A^*$ generated by $f, g$ and $h$.
Then $C = (\setof{A^*}, M, Q, Z, \circ)$ is a category, if $\circ$ denotes the
monoid operation in $M$.

Let $G$ be the graph defined by the following figure:

\begin{center}
\input{figures/chapter1/chapter1-5-example1.tikz}
\end{center}

We define a functor $\phi = (\pathcat{G}, C, \phi_1, \phi_2)$ by
\begin{eqnarray*}
\phi_1(1) & := & A^* \\
\phi_2(e) & := & f \circ g \circ h
\end{eqnarray*}

$\phi_2(\pathcat{G}$ is a subcategory of $C$ (exercise) and it holds:
\[ \phi_2(\pathcat{G})(xyz) = \setof{a^n x b^n y c^n z \mid n \in \mathbb{N}}
\]

\bigskip
{\bf Example 2}:

We continue with example 1. In addition to $f,g,h$ we add three monoid
homomorphisms $f_1, g_1, h_1$ defined by:
\[\begin{array}{l@{,\ }l@{\quad}l}
f_1(x) = \epsilon & f_1(u) = u & \forall u \in A - \setof{x} \\
g_1(y) = \epsilon & g_1(u) = u & \forall u \in A - \setof{y} \\
h_1(z) = \epsilon & h_1(u) = u & \forall u \in A - \setof{z}
\end{array}\]

We extend the graph $G$ as follows to a graph $G_1$:

\begin{center}
\input{figures/chapter1/chapter1-5-example2.tikz}
\end{center}

Consider $\pathcat{G}(G_1)(1,2)$. Then $\pathcat{G_1}(1,2) \cup \setof{1_1,
1_2}$ is a subcategory of $\pathcat{G_1}$. In addition, $\pathcat{G}$ is a subcategory of
$\pathcat{G_1}$.

We extend the functor $\phi$ from example 1 onto $\pathcat{G_1}$ by defining:
\[ \phi_2(e_1) := f_1 \circ g_1 \circ h_1 \]

We get:
\[ \phi_2(\pathcat{G_1}(1,2))(xyz) = \setof{a^n b^n c^n \mid n \in \mathbb{N}}
\]

\bigskip
{\bf Example 3}:

Let $G$ be defined as follows:

\begin{center}
\input{figures/chapter1/chapter1-5-example3-g.tikz}
\end{center}

The full subcategory of $\pathcat{G}$ generated by $\setof{1', 2', 3'}$ is the
path category $\pathcat{G'}$ with the following graph $G'$:

\begin{center}
\input{figures/chapter1/chapter1-5-example3-gprime.tikz}
\end{center}

One can show (exercise): The mapping $\phi_1$ defined by 
\[\begin{array}{l@{\quad}l}
\phi_1(1) = 1' & \phi_1(4) = 1' \\
\phi_1(2) = 2' & \phi_1(5) = 2' \\
\phi_1(3) = 3' & \phi_1(6) = 3'
\end{array}\]
can be extended to a functor $\phi = (\pathcat{G}, \pathcat{G'}, \phi_1,
\phi_2)$ by defining $\phi_2$ in a suitable way.

Remark: The preimage of a closed path does not have to be closed.

We prove now the following
\begin{lemma}
Let \[ C_i = (O_i, M_i, Q, Z, \circ),\ i = 1, 2, 3 \] be categories and $C_1$
and $C_2$ be subcategories of $C_3$. Then $C_1 \cap C_2$ is a category.
\end{lemma}

Proof: It holds
\begin{enumerate}
  \item $w \in O_1 \cap O_2 \Rightarrow 1_w \in M_1 \cap M_2$
  \item $f, g \in M_1 \cap M_2 \Rightarrow f \circ g \in M_1 \cap M_2$, if
  $Z(f) = Q(g)$
\end{enumerate}

It follows that $C_1 \cap C_2$ is a category.

\begin{lemma}
Let $ C_i = (O_i, M_i, Q, Z, \circ),\ i \in I,$\ where $I$ is an arbitrary
index set, be categories. If $C_i,\ i \in I,$ are subcategories of a category
$C$, then 
\[ \tilde{C} := \bigcap_{i \in I} C_i \] 
is a category.
\end{lemma}

The proof is similar as the one of the previous lemma.

\begin{definition}
Let $C = (O, M, Q, Z, \circ)$\ be a category and $O_1 \subset O,\ M_1 \subset M$
and 
\[ \category{U}_C(O_1, M_1) := \setof{C' \mid C'\text{ is subcategory of }C,\
O_1 \subset O',\ M_1 \subset M'} \]
Then 
\[ \generatedby{O_1}{M_1} := \bigcap_{C' \in \category{U}_C(O_1, M_1)} C' \]
is called the {\bf subcategory} of $C$ generated by the {\bf generating system}
$(O_1, M_1)$.
\end{definition}

Obviously for each category $C = (O, M, Q, Z, \circ)$ it holds: $C =
\generatedby{O}{M}$.

We say $M_1$ {\bf generates} \generatedby{O_1}{M_1} if 
\[ O_1 = \setof{Q(m) \mid m \in M_1} \cup \setof{Z(M) \mid m \in M_1} \]

We have already seen an example for a nontrivial generating system.

Let $G=(V,E)$ be a graph, then $E$ is a generating system of $\pathcat{G}$
which means $\pathcat{G} = \generatedbyone{E(G)}$. The path category of a graph
has a special property namely that $E(G)$ is a {\bf free generating system} of
$\pathcat{G}$.

\begin{definition}
Let $C = (O, M, Q, Z, \circ)$ be a category and $E \subset M$. $E$ is called a
{\bf free generating system} of $C$, if the following holds:

If $C' = (O', M', Q, Z, \circ)$ is an arbitrary category and $\phi_1 : O \to O'$
and $\phi_s : E \to M'$ are mappings which fulfill the following diagram:

\begin{center}
\begin{tikzcd}[row sep=large,column sep=huge]
 O \arrow[leftarrow]{r}{Q} \arrow{d}{\phi_1} & E \arrow{r}{Z}
 \arrow{d}{\phi'_2} & O \arrow{d}{\phi_1} \\
 O' \arrow[leftarrow]{r}{Q} & M' \arrow{r}{Z} & O'
\end{tikzcd}
\end{center}

Then there exists a unique continuation of $\phi'_2$ to $\phi_2 : M \to M'$ such
that $\phi = (C, C', \phi_1, \phi_2)$ is a functor.
\end{definition}

\begin{definition}
A category $C$ is called {\bf free} if there exists a free generating system $E$
of $C$.
\end{definition}

We formulate now our observation above as a theorem:

\begin{theorem}
Let $G=(V, E)$ be a graph. Then $E$ is a free generating system of
$\pathcat{G}$.
\end{theorem}

\transrem{In the following proof I had to change the variable names to avoid
confusion}

\begin{proof}
Let $G = (V, E)$ be a graph and $C$ an arbitrary category, let $\phi_1 :
E \to O,\ \phi'_2 : E \to M$ be mappings and the following diagram commute:

\begin{center}
\begin{tikzcd}[column sep=huge,row sep=large]
 V \arrow[leftarrow]{r}{Q} \arrow{d}{\phi_1} & E \arrow{r}{Z}
 \arrow{d}{\phi'_2} & V \arrow{d}{\phi_1} \\
 O \arrow[leftarrow]{r}{Q} & M \arrow{r}{Z} & O
\end{tikzcd}
\end{center}

We define 
\[ \phi_2(v,v) = 1_{\phi_1(v)},v \in V \] 
and 
\[ \phi_2(e) = \phi'_2(e),\ e \in E \]

Let $\phi_2(\pi)$ be defined for all paths $\pi \in \pathcat{G}$ with $|\pi|
\leq n, n \geq 1$ and $\phi_2$ be compatible with $Q$ and $Z$ for all these
paths $\pi$.

Further let $\phi_2$ be uniquely determined for these paths $\pi$ and it holds:
\[ \phi_2(\pi \cdot \psi) = \phi_2(\pi) \cdot \phi_2(\psi) \]
for all $\pi, \psi$ with $|\pi \cdot \psi| \leq n$.

Now let $\omega = (v, e_1, \ldots, e_{n+1}, v') \in \pathcat{G}$. We split
$\omega$ into 
\[ \omega = (v, \underbrace{e_1, \ldots, e_n}_{\omega_1}, v'') \cdot (v'',
\underbrace{e_{n+1}}_{\omega_2}, v') \].

By induction hypothesis, $\phi_2(\omega_1)$ and $\phi_2(\omega_2)$ are defined.

For $\phi_2$ to become a functor, necessarily $\phi_2(\omega) = \phi_2(\omega_1)
\cdot \phi_2(\omega_2)$ must hold.

By assumption, $\phi_2$ is compatible with source and target mappings $Q$ and
$Z$ for $\omega_1$ and $\omega_2$. Therefore $Z(\phi_2(\omega_1)) =
Q(\phi_2(\omega_2))$ and $\phi_2(\omega)$ are defined.

Let $\omega = \psi_1 \cdot \psi_2$ be any partition of $\omega$, so 
\[ \omega = (v, \underbrace{e_1, \ldots, e_j}_{\psi_1}, \bar{v}) \cdot (\bar{v},
\underbrace{e_{j+1}, \ldots, e_{n+1}}_{\psi_2}, v') \]

By induction hypothesis it holds:
\begin{enumerate}
  \item $Z(\phi_2(\psi_1)) = Q(\phi_2(\psi_2))$, so $\phi_2(\psi_1) \cdot
  \phi_2(\psi_2)$ is defined.
  \item With $\psi'_2 = (\bar{v}, e_{j+1}, \ldots, e_n, v'')$ we have
  \begin{eqnarray*}
  \phi_2(\psi_1) \cdot \phi_2(\psi_2) & = & \phi_2(\psi_1) \cdot
  (\phi_2(\psi'_2) \cdot \phi_2(\psi_2)) \\
  & = & (\phi_2(\psi_1) \cdot \phi_2(\psi'_2)) \cdot \phi_2(\omega_2) \\
  & = & \phi_2(\omega_1) \cdot \phi_2(\omega_2) \\
  & = & \phi_2(\omega)
  \end{eqnarray*}
\end{enumerate}

It remains to show 
\[ \phi_1(Q(\omega)) = Q(\phi_2(\omega)),\quad \phi_1(Z(\omega)) =
Z(\phi_2(\omega)) \]

This follows directly from $Q(\omega) = Q(\omega_1)$ and $Z(\omega) =
Z(\omega_2)$ by application of the induction hypothesis.
\end{proof}

\bigskip
\begin{theorem}
To each category $C$ there exists a free category $F$ and a surjective functor
$\phi = (F, C, \phi_1, \phi_2)$.
\end{theorem}

\begin{proof}
For the category $C$ we create an oriented graph $G_C = (V, E)$ with 
\begin{eqnarray*}
V &=& Obj(C) \\
E &=& \setof{f \mid Q(f) = O_1,\ Z(f) = O_2,\ f : O_1 \to O_2 \in M}
\end{eqnarray*}
i.e\ the objects of the category become the points (vertices) of the graph and
each morphism becomes an edge. Because $\pathcat{G_C}$ is a free category by
theorem 1, we can choose $F$ to be exactly this category.

Let $\phi_1 : V \to O$ with $\phi_1(w) = w$ and $\phi'_2 : E \to M$ with
$\phi'_2(f) = f$ be mappings and $\phi_2 : \pathcat{G_C} \to M$ be the
continuation of $\phi'_2$ such that $\phi = (\pathcat{G_C}, C, \phi_1, \phi_2)$
becomes a functor.

By construction, $\phi$ is surjective.
\end{proof}

\bigskip
The following theorem tells about the uniqueness of free generating systems.
\begin{theorem}
If $E$ and $E'$ are free generating systems of a category $F$, then $E = E'$.
\end{theorem}

The proof is similar to prrof of the corresponding theorem for free monoids.
